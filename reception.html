<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>PWA Limpieza Hotel - Recepción</title>

    <link rel="manifest" href="/manifest.json" />

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Nuevo CSS exclusivo para Recepción -->
    <link rel="stylesheet" href="/src/reception.css" />
</head>

<body>

<header class="topbar">
    <h1>Recepción</h1>
    <nav>
        <a href="/index.html">Cerrar sesión</a>
    </nav>
</header>

<main class="container">

    <!-- =======================
           HABITACIONES
    =========================-->
    <section class="card">
        <div class="card-header">
            <h2>Habitaciones</h2>
            <div class="controls">
                <button id="btnAddRoom" class="btn btn-primary">
                    <i class="bi bi-plus-circle"></i> Nueva Habitación
                </button>
            </div>
        </div>

        <div id="roomsList" class="grid"></div>

        <div class="pagination" id="roomsPager"></div>
    </section>

    <!-- =======================
           CAMARERAS
    =========================-->
    <section class="card">
        <div class="card-header">
            <h2>Camareras</h2>
            <div class="controls">
                <button id="btnAddMaid" class="btn btn-primary">
                    <i class="bi bi-person-plus"></i> Nueva Camarera
                </button>
            </div>
        </div>

        <div id="maidsList"></div>

        <div class="pagination" id="maidsPager"></div>
    </section>

    <!-- =======================
           HISTORIAL DE REPORTES
    =========================-->
    <section class="card">
        <h2>Historial de reportes</h2>

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Fecha</th>
                        <th>Habitación</th>
                        <th>Camarera</th>
                        <th>Descripción</th>
                        <th>Imágenes</th>
                    </tr>
                </thead>
                <tbody id="reportsList"></tbody>
            </table>
        </div>

        <div class="pagination" id="reportsPager"></div>
    </section>

</main>

<!-- =======================
        MODAL GENERAL 
===========================-->
<div id="modal" class="modal hidden">
    <div class="content" id="modalContent"></div>
</div>

<!-- =======================
        MODAL VER IMÁGENES
===========================-->
<div id="imgModal" class="modal hidden img-viewer">
    <div class="modal-content img-content text-center">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <button id="imgPrev" class="btn btn-sm btn-outline-secondary"><i class="bi bi-chevron-left"></i></button>
            <div><small id="imgCounter"></small></div>
            <button id="imgNext" class="btn btn-sm btn-outline-secondary"><i class="bi bi-chevron-right"></i></button>
        </div>
        <img id="modalImg" src="" alt="Imagen del reporte" style="max-width:100%; max-height:60vh; border-radius:6px;" />
    </div>
</div>

<!-- Script principal -->
<script type="module" src="/src/reception.js"></script>

<script>
/* ============================
   Modal para ver imágenes
============================ */
window.openImagesModal = function (images) {
    if (!Array.isArray(images) || !images.length) return;
    window._imgGallery = images.slice();
    window._imgIndex = 0;
    const imgEl = document.getElementById('modalImg');
    const counter = document.getElementById('imgCounter');
    imgEl.src = window._imgGallery[0];
    counter.textContent = `1 / ${window._imgGallery.length}`;
    document.getElementById('imgModal').classList.remove('hidden');
};

document.getElementById('imgPrev').addEventListener('click', (e) => {
    e.stopPropagation();
    if (!window._imgGallery) return;
    window._imgIndex = (window._imgIndex - 1 + window._imgGallery.length) % window._imgGallery.length;
    document.getElementById('modalImg').src = window._imgGallery[window._imgIndex];
    document.getElementById('imgCounter').textContent = `${window._imgIndex + 1} / ${window._imgGallery.length}`;
});

document.getElementById('imgNext').addEventListener('click', (e) => {
    e.stopPropagation();
    if (!window._imgGallery) return;
    window._imgIndex = (window._imgIndex + 1) % window._imgGallery.length;
    document.getElementById('modalImg').src = window._imgGallery[window._imgIndex];
    document.getElementById('imgCounter').textContent = `${window._imgIndex + 1} / ${window._imgGallery.length}`;
});

// cerrar al hacer click en fondo
document.getElementById('imgModal').addEventListener('click', (e) => {
    if (e.target.id === 'imgModal') {
        document.getElementById('imgModal').classList.add('hidden');
    }
});
</script>

</body>
</html>
